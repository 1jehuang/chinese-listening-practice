<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Radical Practice</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="css/common.css">
    <script src="js/utils.js"></script>
    <style>
        .option-btn {
            font-size: 48px;
            padding: 30px;
            border: 2px solid #d1d5db;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: normal;
        }

        .option-btn:hover:not(:disabled) {
            background: #f3f4f6;
            border-color: #9ca3af;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .option-btn:active:not(:disabled) {
            transform: translateY(0);
        }

        .mode-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        .character, .radical {
            font-family: "Noto Sans SC", "Microsoft YaHei", sans-serif;
        }

        .meaning {
            font-size: 1.5rem;
            color: #6b7280;
            margin-top: 0.5rem;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen p-4 md:p-8">
    <a href="home.html" class="fixed top-4 left-4 bg-white hover:bg-gray-100 text-gray-700 px-3 py-2 rounded-lg shadow border border-gray-200 transition text-sm">← Home</a>
    <div class="max-w-3xl mx-auto bg-white rounded-xl shadow-lg p-6 md:p-8 mt-16 md:mt-0">
        <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">部首大全 Comprehensive Radical Practice</h1>

        <div class="flex flex-wrap gap-2 justify-center mb-6">
            <button class="mode-btn px-4 py-2 rounded-lg border-2 border-blue-500 bg-blue-500 text-white transition" data-mode="radical-meaning">Radical Meaning</button>
            <button class="mode-btn px-4 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition" data-mode="char-to-radical">Character → Radical</button>
            <button class="mode-btn px-4 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition" data-mode="radical-to-char">Radical → Character</button>
        </div>

        <div id="charToRadicalMode" style="display: none;">
            <div class="text-center text-gray-600 mb-4">What is the radical of this character?</div>
            <div class="text-center text-8xl my-8 font-normal text-gray-800">
                <div class="character" id="character"></div>
            </div>
            <div class="grid grid-cols-2 gap-3" id="radicalOptions"></div>
        </div>

        <div id="radicalToCharMode" style="display: none;">
            <div class="text-center text-gray-600 mb-4">Which character contains this radical?</div>
            <div class="text-center text-8xl my-8 font-normal text-gray-800">
                <div class="radical" id="radical"></div>
                <div class="text-2xl mt-4 text-gray-600">
                    <span id="radicalMeaning"></span>
                    <span id="radicalVariant" class="ml-2 text-gray-500"></span>
                </div>
            </div>
            <div class="grid grid-cols-2 gap-3" id="charOptions"></div>
        </div>

        <div id="radicalMeaningMode">
            <div class="text-center text-gray-600 mb-4">What does this radical mean? (Click radical to hear pronunciation)</div>
            <div class="text-center text-8xl my-8 font-normal text-gray-800">
                <div class="radical" id="radicalForMeaning" style="cursor: pointer;" title="Click to hear pronunciation"></div>
                <div id="variantInfo" class="text-2xl mt-4 text-gray-500"></div>
            </div>
            <input type="text" id="meaningInput" placeholder="Type the meaning..." style="width: 100%; padding: 15px; font-size: 18px; border: 2px solid #ddd; border-radius: 8px; margin-bottom: 15px; box-sizing: border-box;">
            <div class="grid grid-cols-2 gap-3" id="meaningOptions"></div>
        </div>

        <div class="text-center font-semibold my-4 min-h-[24px]" id="feedback"></div>

        <button class="w-full bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg font-medium transition mt-4" id="nextBtn">Next Question →</button>

        <div class="flex justify-between text-sm text-gray-600 pt-4 mt-4 border-t border-gray-200">
            <div>Score: <span class="font-semibold" id="score">0</span>/<span class="font-semibold" id="total">0</span> <span class="ml-2">(<span class="font-semibold" id="percentage">0</span>%)</span></div>
        </div>
    </div>

    <script>
        // Comprehensive radical data with both full form and variant forms
        const radicalData = [
            // 1-stroke radicals
            { radical: '一', variants: [], meaning: 'one/horizontal', pinyin: 'yī', chars: ['一', '二', '三', '上', '下', '万', '丈', '与'] },
            { radical: '丨', variants: [], meaning: 'line/vertical', pinyin: 'gǔn', chars: ['中', '丰', '串', '临'] },
            { radical: '丶', variants: [], meaning: 'dot', pinyin: 'diǎn', chars: ['主', '义', '为', '丹'] },
            { radical: '丿', variants: [], meaning: 'slash', pinyin: 'piě', chars: ['久', '么', '之', '乏'] },
            { radical: '乙', variants: [], meaning: 'second/bend', pinyin: 'yǐ', chars: ['乙', '九', '也', '习', '书'] },
            { radical: '亅', variants: [], meaning: 'hook', pinyin: 'jué', chars: ['了', '予', '争', '事'] },

            // 2-stroke radicals
            { radical: '二', variants: [], meaning: 'two', pinyin: 'èr', chars: ['二', '于', '云', '互', '五'] },
            { radical: '亠', variants: [], meaning: 'lid', pinyin: 'tóu', chars: ['亡', '交', '亦', '京', '亮', '高'] },
            { radical: '人', variants: ['亻'], meaning: 'person', pinyin: 'rén', chars: ['人', '你', '他', '们', '什', '住', '作', '休', '体', '从', '今', '介'] },
            { radical: '儿', variants: [], meaning: 'legs/child', pinyin: 'ér', chars: ['儿', '元', '兄', '充', '先', '光', '克'] },
            { radical: '入', variants: [], meaning: 'enter', pinyin: 'rù', chars: ['入', '内', '全'] },
            { radical: '八', variants: [], meaning: 'eight/divide', pinyin: 'bā', chars: ['八', '公', '六', '共', '兵', '其', '典'] },
            { radical: '冂', variants: [], meaning: 'wide', pinyin: 'jiōng', chars: ['冂', '冈', '冉', '册', '再'] },
            { radical: '冖', variants: [], meaning: 'cover', pinyin: 'mì', chars: ['冖', '军', '写', '冠'] },
            { radical: '冫', variants: [], meaning: 'ice', pinyin: 'bīng', chars: ['冰', '冷', '冻', '净', '凉', '准'] },
            { radical: '几', variants: [], meaning: 'table', pinyin: 'jī', chars: ['几', '凡', '凤', '凭'] },
            { radical: '凵', variants: [], meaning: 'container', pinyin: 'kǎn', chars: ['凶', '出', '函'] },
            { radical: '刀', variants: ['刂'], meaning: 'knife', pinyin: 'dāo', chars: ['刀', '分', '切', '刊', '划', '列', '则', '刚', '创', '别', '利', '到'] },
            { radical: '力', variants: [], meaning: 'power/strength', pinyin: 'lì', chars: ['力', '加', '助', '动', '办', '功', '劳'] },
            { radical: '勹', variants: [], meaning: 'wrap', pinyin: 'bāo', chars: ['勺', '包', '匀'] },
            { radical: '匕', variants: [], meaning: 'spoon', pinyin: 'bǐ', chars: ['匕', '比', '北'] },
            { radical: '匚', variants: [], meaning: 'box', pinyin: 'fāng', chars: ['匚', '匠', '匡', '匹'] },
            { radical: '匸', variants: [], meaning: 'hiding', pinyin: 'xì', chars: ['匿', '区'] },
            { radical: '十', variants: [], meaning: 'ten', pinyin: 'shí', chars: ['十', '千', '午', '半', '华', '协', '南', '博'] },
            { radical: '卜', variants: [], meaning: 'divination', pinyin: 'bǔ', chars: ['卜', '占', '卡', '卦'] },
            { radical: '卩', variants: [], meaning: 'seal', pinyin: 'jié', chars: ['卫', '印', '危', '即'] },
            { radical: '厂', variants: [], meaning: 'cliff', pinyin: 'hǎn', chars: ['厂', '厅', '历', '原', '厨'] },
            { radical: '厶', variants: [], meaning: 'private', pinyin: 'sī', chars: ['厶', '去', '参', '台'] },
            { radical: '又', variants: [], meaning: 'again/right hand', pinyin: 'yòu', chars: ['又', '及', '友', '双', '反', '发'] },

            // 3-stroke radicals
            { radical: '口', variants: [], meaning: 'mouth', pinyin: 'kǒu', chars: ['口', '吃', '喝', '叫', '吗', '呢', '唱', '哪', '听', '告', '吹', '吸'] },
            { radical: '囗', variants: [], meaning: 'enclosure', pinyin: 'wéi', chars: ['囗', '四', '回', '因', '困', '国', '图', '团'] },
            { radical: '土', variants: [], meaning: 'earth', pinyin: 'tǔ', chars: ['土', '地', '场', '坐', '城', '在', '块', '坏', '墙', '型', '均'] },
            { radical: '士', variants: [], meaning: 'scholar', pinyin: 'shì', chars: ['士', '壮', '声', '壳'] },
            { radical: '夂', variants: [], meaning: 'go slowly', pinyin: 'zhǐ', chars: ['夏', '复', '处'] },
            { radical: '夊', variants: [], meaning: 'go', pinyin: 'suī', chars: ['冬', '各', '备'] },
            { radical: '夕', variants: [], meaning: 'evening', pinyin: 'xī', chars: ['夕', '外', '多', '夜', '够', '梦'] },
            { radical: '大', variants: [], meaning: 'big', pinyin: 'dà', chars: ['大', '天', '太', '夫', '央', '失', '头', '夹', '奇', '奔'] },
            { radical: '女', variants: [], meaning: 'woman', pinyin: 'nǚ', chars: ['女', '好', '她', '妈', '姐', '妹', '姓', '如', '娘', '妇', '始'] },
            { radical: '子', variants: [], meaning: 'child', pinyin: 'zǐ', chars: ['子', '字', '存', '孙', '学', '孩'] },
            { radical: '宀', variants: [], meaning: 'roof', pinyin: 'mián', chars: ['宀', '家', '宿', '客', '室', '宝', '完', '安', '字', '定', '宅'] },
            { radical: '寸', variants: [], meaning: 'inch', pinyin: 'cùn', chars: ['寸', '寺', '封', '射', '将', '尊'] },
            { radical: '小', variants: ['⺌'], meaning: 'small', pinyin: 'xiǎo', chars: ['小', '少', '尖', '尘', '尚', '当'] },
            { radical: '尢', variants: [], meaning: 'lame', pinyin: 'wāng', chars: ['尤', '就', '尴'] },
            { radical: '尸', variants: [], meaning: 'corpse', pinyin: 'shī', chars: ['尸', '尺', '尼', '尾', '局', '居', '屋', '展'] },
            { radical: '屮', variants: [], meaning: 'sprout', pinyin: 'chè', chars: ['屯', '屯'] },
            { radical: '山', variants: [], meaning: 'mountain', pinyin: 'shān', chars: ['山', '岁', '岛', '岩', '峰', '崖'] },
            { radical: '巛', variants: [], meaning: 'river', pinyin: 'chuān', chars: ['巡', '巢', '州'] },
            { radical: '工', variants: [], meaning: 'work', pinyin: 'gōng', chars: ['工', '左', '巧', '巨', '差', '项'] },
            { radical: '己', variants: [], meaning: 'oneself', pinyin: 'jǐ', chars: ['己', '已', '巳', '巴'] },
            { radical: '巾', variants: [], meaning: 'cloth/towel', pinyin: 'jīn', chars: ['巾', '布', '市', '帆', '希', '帮', '帽', '幕'] },
            { radical: '干', variants: [], meaning: 'dry/stem', pinyin: 'gān', chars: ['干', '平', '年', '并'] },
            { radical: '幺', variants: [], meaning: 'tiny', pinyin: 'yāo', chars: ['幼', '幻'] },
            { radical: '广', variants: [], meaning: 'shelter', pinyin: 'guǎng', chars: ['广', '应', '店', '府', '度', '座', '康', '庭'] },
            { radical: '廴', variants: [], meaning: 'stride', pinyin: 'yǐn', chars: ['延', '建'] },
            { radical: '廾', variants: [], meaning: 'two hands', pinyin: 'gǒng', chars: ['开', '弁', '异'] },
            { radical: '弋', variants: [], meaning: 'shoot', pinyin: 'yì', chars: ['弋', '式', '代'] },
            { radical: '弓', variants: [], meaning: 'bow', pinyin: 'gōng', chars: ['弓', '引', '张', '弟', '弱', '强'] },

            // 4-stroke radicals
            { radical: '彐', variants: [], meaning: 'pig snout', pinyin: 'jì', chars: ['归', '当'] },
            { radical: '彡', variants: [], meaning: 'hair/whiskers', pinyin: 'shān', chars: ['形', '彩', '影'] },
            { radical: '彳', variants: [], meaning: 'step', pinyin: 'chì', chars: ['行', '往', '径', '待', '很', '得', '街', '律'] },
            { radical: '心', variants: ['忄', '⺗'], meaning: 'heart', pinyin: 'xīn', chars: ['心', '想', '忙', '忘', '思', '意', '您', '念', '怎', '快', '性', '怕', '情', '惊', '恨', '忆', '恩', '悲'] },
            { radical: '戈', variants: [], meaning: 'halberd/spear', pinyin: 'gē', chars: ['戈', '成', '我', '战', '或', '戒'] },
            { radical: '戶', variants: ['户'], meaning: 'door', pinyin: 'hù', chars: ['戶', '房', '所', '扇', '扁'] },
            { radical: '手', variants: ['扌', '龵'], meaning: 'hand', pinyin: 'shǒu', chars: ['手', '打', '找', '把', '拉', '推', '拿', '接', '换', '扫', '执', '扩', '抱', '持'] },
            { radical: '支', variants: [], meaning: 'branch', pinyin: 'zhī', chars: ['支', '技', '枝'] },
            { radical: '攴', variants: ['攵'], meaning: 'tap/strike', pinyin: 'pū', chars: ['收', '改', '放', '政', '故', '教', '敢', '散'] },
            { radical: '文', variants: [], meaning: 'script/writing', pinyin: 'wén', chars: ['文', '齐', '斋'] },
            { radical: '斗', variants: [], meaning: 'dipper/measure', pinyin: 'dǒu', chars: ['斗', '料', '斜'] },
            { radical: '斤', variants: [], meaning: 'axe/catty', pinyin: 'jīn', chars: ['斤', '斥', '新', '断'] },
            { radical: '方', variants: [], meaning: 'square/direction', pinyin: 'fāng', chars: ['方', '施', '旁', '旅', '族'] },
            { radical: '无', variants: [], meaning: 'not/without', pinyin: 'wú', chars: ['无', '既'] },
            { radical: '日', variants: [], meaning: 'sun/day', pinyin: 'rì', chars: ['日', '明', '时', '晚', '早', '星', '晴', '春', '昨', '暗', '暖', '映', '是'] },
            { radical: '曰', variants: [], meaning: 'say', pinyin: 'yuē', chars: ['曰', '曲', '更', '曹'] },
            { radical: '月', variants: [], meaning: 'moon/month/meat', pinyin: 'yuè', chars: ['月', '期', '有', '朋', '服', '朝', '脸', '肚', '胖', '肉', '肥', '肤', '胃', '胸'] },
            { radical: '木', variants: [], meaning: 'wood/tree', pinyin: 'mù', chars: ['木', '林', '校', '树', '桌', '椅', '机', '杯', '桥', '李', '村', '本', '材', '果', '根'] },
            { radical: '欠', variants: [], meaning: 'lack/yawn', pinyin: 'qiàn', chars: ['欠', '次', '欢', '欲', '歌'] },
            { radical: '止', variants: [], meaning: 'stop', pinyin: 'zhǐ', chars: ['止', '正', '此', '步', '武', '歧'] },
            { radical: '歹', variants: [], meaning: 'death/evil', pinyin: 'dǎi', chars: ['死', '歼', '残'] },
            { radical: '殳', variants: [], meaning: 'weapon', pinyin: 'shū', chars: ['段', '殴', '殷'] },
            { radical: '毋', variants: [], meaning: 'do not', pinyin: 'wú', chars: ['毋', '毒'] },
            { radical: '比', variants: [], meaning: 'compare', pinyin: 'bǐ', chars: ['比', '毕', '毙'] },
            { radical: '毛', variants: [], meaning: 'fur/hair', pinyin: 'máo', chars: ['毛', '毯', '毡'] },
            { radical: '氏', variants: [], meaning: 'clan', pinyin: 'shì', chars: ['氏', '民', '氓'] },
            { radical: '气', variants: [], meaning: 'gas/air', pinyin: 'qì', chars: ['气', '氧', '氛', '氮'] },
            { radical: '水', variants: ['氵', '氺'], meaning: 'water', pinyin: 'shuǐ', chars: ['水', '河', '海', '洋', '汉', '法', '洗', '汽', '没', '江', '油', '波', '泪', '洞', '注', '洁'] },
            { radical: '火', variants: ['灬'], meaning: 'fire', pinyin: 'huǒ', chars: ['火', '热', '烧', '烤', '灯', '炒', '炮', '然', '烟', '灰', '灾', '炼', '煮', '照'] },
            { radical: '爪', variants: ['爫'], meaning: 'claw', pinyin: 'zhǎo', chars: ['爪', '采', '爬', '爱', '受', '爵'] },
            { radical: '父', variants: [], meaning: 'father', pinyin: 'fù', chars: ['父', '爷', '爸'] },
            { radical: '爻', variants: [], meaning: 'yao/intertwined', pinyin: 'yáo', chars: ['爻', '爽'] },
            { radical: '爿', variants: [], meaning: 'half tree trunk', pinyin: 'pán', chars: ['片', '版', '牌'] },
            { radical: '片', variants: [], meaning: 'slice', pinyin: 'piàn', chars: ['片', '版', '牌', '牒'] },
            { radical: '牙', variants: [], meaning: 'tooth/fang', pinyin: 'yá', chars: ['牙', '邪'] },
            { radical: '牛', variants: ['牜'], meaning: 'cow', pinyin: 'niú', chars: ['牛', '牧', '物', '特', '犁', '犊'] },
            { radical: '犬', variants: ['犭'], meaning: 'dog', pinyin: 'quǎn', chars: ['犬', '狗', '猫', '狼', '狂', '独', '狮', '猪', '狐'] },

            // 5-stroke radicals
            { radical: '玄', variants: [], meaning: 'dark/mysterious', pinyin: 'xuán', chars: ['玄', '率'] },
            { radical: '玉', variants: ['玊', '王'], meaning: 'jade', pinyin: 'yù', chars: ['玉', '玩', '珍', '现', '球', '理', '班', '环', '璃', '珠'] },
            { radical: '瓜', variants: [], meaning: 'melon', pinyin: 'guā', chars: ['瓜', '瓣', '瓢'] },
            { radical: '瓦', variants: [], meaning: 'tile', pinyin: 'wǎ', chars: ['瓦', '瓶', '瓷'] },
            { radical: '甘', variants: [], meaning: 'sweet', pinyin: 'gān', chars: ['甘', '甚', '某'] },
            { radical: '生', variants: [], meaning: 'life/birth', pinyin: 'shēng', chars: ['生', '产', '甥'] },
            { radical: '用', variants: [], meaning: 'use', pinyin: 'yòng', chars: ['用', '甩', '甫'] },
            { radical: '田', variants: [], meaning: 'field', pinyin: 'tián', chars: ['田', '男', '界', '畜', '留', '略', '番'] },
            { radical: '疋', variants: [], meaning: 'bolt of cloth', pinyin: 'pǐ', chars: ['疋', '疏'] },
            { radical: '疒', variants: [], meaning: 'sickness', pinyin: 'nè', chars: ['病', '疼', '痛', '瘦', '疯', '痒', '疲', '疾', '症', '疗'] },
            { radical: '癶', variants: [], meaning: 'footsteps', pinyin: 'bō', chars: ['登', '发'] },
            { radical: '白', variants: [], meaning: 'white', pinyin: 'bái', chars: ['白', '百', '的', '皇', '皮'] },
            { radical: '皮', variants: [], meaning: 'skin', pinyin: 'pí', chars: ['皮', '皱', '皴'] },
            { radical: '皿', variants: [], meaning: 'dish', pinyin: 'mǐn', chars: ['皿', '盆', '盐', '益', '盖', '盏'] },
            { radical: '目', variants: [], meaning: 'eye', pinyin: 'mù', chars: ['目', '看', '眼', '睛', '睡', '眉', '盯', '瞧', '盲', '眠', '督', '直'] },
            { radical: '矛', variants: [], meaning: 'spear', pinyin: 'máo', chars: ['矛', '矜'] },
            { radical: '矢', variants: [], meaning: 'arrow', pinyin: 'shǐ', chars: ['矢', '知', '短', '矮'] },
            { radical: '石', variants: [], meaning: 'stone', pinyin: 'shí', chars: ['石', '砖', '破', '研', '硬', '矿', '码'] },
            { radical: '示', variants: ['礻'], meaning: 'spirit/show', pinyin: 'shì', chars: ['示', '社', '神', '祝', '祖', '礼', '福', '祥', '票'] },
            { radical: '禸', variants: [], meaning: 'track', pinyin: 'róu', chars: ['禹', '离'] },
            { radical: '禾', variants: [], meaning: 'grain', pinyin: 'hé', chars: ['禾', '和', '科', '秋', '种', '秒', '称', '移', '程', '税'] },
            { radical: '穴', variants: [], meaning: 'cave', pinyin: 'xué', chars: ['穴', '空', '究', '穷', '窗', '窝'] },
            { radical: '立', variants: [], meaning: 'stand', pinyin: 'lì', chars: ['立', '站', '童', '端', '竞'] },

            // 6+ stroke radicals
            { radical: '竹', variants: ['⺮'], meaning: 'bamboo', pinyin: 'zhú', chars: ['竹', '笑', '笔', '等', '答', '算', '简', '箱', '篮', '筷', '节', '管'] },
            { radical: '米', variants: [], meaning: 'rice', pinyin: 'mǐ', chars: ['米', '类', '粉', '粗', '糊', '精'] },
            { radical: '糸', variants: ['糹', '纟'], meaning: 'silk/thread', pinyin: 'mì', chars: ['红', '级', '纸', '经', '给', '绿', '线', '细', '纯', '纳', '纷', '织', '终', '组', '结', '绕'] },
            { radical: '缶', variants: [], meaning: 'jar', pinyin: 'fǒu', chars: ['缶', '缸', '缺'] },
            { radical: '网', variants: ['罒', '网'], meaning: 'net', pinyin: 'wǎng', chars: ['网', '罗', '罚', '置', '罩'] },
            { radical: '羊', variants: ['⺶', '⺷'], meaning: 'sheep', pinyin: 'yáng', chars: ['羊', '美', '羞', '群', '差', '养'] },
            { radical: '羽', variants: [], meaning: 'feather', pinyin: 'yǔ', chars: ['羽', '翅', '翔', '翠'] },
            { radical: '老', variants: ['耂'], meaning: 'old', pinyin: 'lǎo', chars: ['老', '考', '者'] },
            { radical: '而', variants: [], meaning: 'and/beard', pinyin: 'ér', chars: ['而', '耍', '耐'] },
            { radical: '耒', variants: [], meaning: 'plow', pinyin: 'lěi', chars: ['耕', '耘'] },
            { radical: '耳', variants: [], meaning: 'ear', pinyin: 'ěr', chars: ['耳', '取', '闻', '联', '职'] },
            { radical: '聿', variants: [], meaning: 'brush', pinyin: 'yù', chars: ['聿', '肃', '律'] },
            { radical: '肉', variants: ['⺼'], meaning: 'meat/flesh', pinyin: 'ròu', chars: ['肉', '肯', '肠', '育', '胜'] },
            { radical: '臣', variants: [], meaning: 'minister', pinyin: 'chén', chars: ['臣', '卧', '臭'] },
            { radical: '自', variants: [], meaning: 'self/nose', pinyin: 'zì', chars: ['自', '臭', '息'] },
            { radical: '至', variants: [], meaning: 'arrive', pinyin: 'zhì', chars: ['至', '致', '台'] },
            { radical: '臼', variants: [], meaning: 'mortar', pinyin: 'jiù', chars: ['臼', '舂', '舅'] },
            { radical: '舌', variants: [], meaning: 'tongue', pinyin: 'shé', chars: ['舌', '舍', '舐'] },
            { radical: '舛', variants: [], meaning: 'oppose', pinyin: 'chuǎn', chars: ['舞', '舜'] },
            { radical: '舟', variants: [], meaning: 'boat', pinyin: 'zhōu', chars: ['舟', '船', '航', '般'] },
            { radical: '艮', variants: [], meaning: 'stubborn', pinyin: 'gèn', chars: ['艮', '良', '根'] },
            { radical: '色', variants: [], meaning: 'color', pinyin: 'sè', chars: ['色', '艳'] },
            { radical: '艸', variants: ['艹', '⺾'], meaning: 'grass', pinyin: 'cǎo', chars: ['茶', '花', '草', '菜', '药', '蓝', '葡', '萄', '英', '苦', '节', '营', '落', '著', '莫'] },
            { radical: '虍', variants: [], meaning: 'tiger', pinyin: 'hū', chars: ['虎', '虑', '虚'] },
            { radical: '虫', variants: [], meaning: 'insect', pinyin: 'chóng', chars: ['虫', '蛇', '蚂', '蚁', '蜂', '蜘', '蛛', '蝴', '蝶', '螺', '蛙'] },
            { radical: '血', variants: [], meaning: 'blood', pinyin: 'xuè', chars: ['血', '衅'] },
            { radical: '行', variants: [], meaning: 'go/walk', pinyin: 'xíng', chars: ['行', '街', '衡', '衍'] },
            { radical: '衣', variants: ['衤', '⻂'], meaning: 'clothing', pinyin: 'yī', chars: ['衣', '裤', '被', '补', '袜', '裙', '袋', '裹', '初', '衫', '袍', '裁', '表'] },
            { radical: '襾', variants: ['西'], meaning: 'cover', pinyin: 'yà', chars: ['要', '覆'] },

            // 7+ stroke radicals
            { radical: '见', variants: [], meaning: 'see', pinyin: 'jiàn', chars: ['见', '视', '观', '规', '觉'] },
            { radical: '角', variants: [], meaning: 'horn/corner', pinyin: 'jiǎo', chars: ['角', '解', '触'] },
            { radical: '言', variants: ['訁', '讠'], meaning: 'speech/words', pinyin: 'yán', chars: ['言', '说', '话', '语', '认', '识', '请', '谢', '让', '词', '议', '论', '讲', '计', '记', '诉', '许'] },
            { radical: '谷', variants: [], meaning: 'valley', pinyin: 'gǔ', chars: ['谷', '豁', '容'] },
            { radical: '豆', variants: [], meaning: 'bean', pinyin: 'dòu', chars: ['豆', '豌', '短'] },
            { radical: '豕', variants: [], meaning: 'pig', pinyin: 'shǐ', chars: ['豕', '家', '象'] },
            { radical: '豸', variants: [], meaning: 'badger', pinyin: 'zhì', chars: ['豺', '貌'] },
            { radical: '贝', variants: ['貝'], meaning: 'shell/money', pinyin: 'bèi', chars: ['贝', '贵', '财', '货', '贫', '购', '贸', '费', '资', '贺', '赏', '赛'] },
            { radical: '赤', variants: [], meaning: 'red', pinyin: 'chì', chars: ['赤', '赫'] },
            { radical: '走', variants: ['赱'], meaning: 'run/walk', pinyin: 'zǒu', chars: ['走', '起', '超', '越', '趣', '趟'] },
            { radical: '足', variants: ['⻊'], meaning: 'foot', pinyin: 'zú', chars: ['足', '跑', '跳', '路', '踢', '跟', '距', '趴', '蹦', '跌', '跪', '跨'] },
            { radical: '身', variants: [], meaning: 'body', pinyin: 'shēn', chars: ['身', '躬', '躲', '躯'] },
            { radical: '车', variants: [], meaning: 'vehicle/cart', pinyin: 'chē', chars: ['车', '轮', '软', '轻', '载', '辆', '转', '较', '轨', '辈'] },
            { radical: '辛', variants: [], meaning: 'bitter', pinyin: 'xīn', chars: ['辛', '辣', '辞'] },
            { radical: '辰', variants: [], meaning: 'morning', pinyin: 'chén', chars: ['辰', '辱', '农'] },
            { radical: '辵', variants: ['⻍', '⻌'], meaning: 'walk', pinyin: 'chuò', chars: ['过', '还', '进', '远', '近', '送', '道', '连', '迎', '运', '追', '退', '速', '逃', '造', '选', '通', '达'] },
            { radical: '邑', variants: ['⻏'], meaning: 'city', pinyin: 'yì', chars: ['部', '都', '郎', '郊', '邦', '那', '邮'] },
            { radical: '酉', variants: [], meaning: 'wine/alcohol', pinyin: 'yǒu', chars: ['酉', '酒', '配', '酸', '醉', '醒', '醇'] },
            { radical: '釆', variants: [], meaning: 'distinguish', pinyin: 'biàn', chars: ['釆', '释', '番'] },
            { radical: '里', variants: [], meaning: 'village/li', pinyin: 'lǐ', chars: ['里', '量', '野', '重'] },

            // 8+ stroke radicals
            { radical: '金', variants: ['釒', '钅'], meaning: 'metal/gold', pinyin: 'jīn', chars: ['金', '钱', '铁', '银', '错', '钟', '锅', '铜', '钢', '针', '钉', '铃', '锁', '镜'] },
            { radical: '长', variants: [], meaning: 'long', pinyin: 'cháng', chars: ['长', '张', '账'] },
            { radical: '门', variants: [], meaning: 'gate/door', pinyin: 'mén', chars: ['门', '问', '间', '闭', '开', '闲', '闻', '阔'] },
            { radical: '阜', variants: ['⻖'], meaning: 'mound', pinyin: 'fù', chars: ['阳', '阴', '队', '防', '阶', '陆', '院', '除', '降', '限', '际', '险', '陪'] },
            { radical: '隶', variants: [], meaning: 'slave', pinyin: 'lì', chars: ['隶', '隽'] },
            { radical: '隹', variants: [], meaning: 'short-tailed bird', pinyin: 'zhuī', chars: ['隹', '难', '集', '雀', '雁', '雄', '雅'] },
            { radical: '雨', variants: ['⻗'], meaning: 'rain', pinyin: 'yǔ', chars: ['雨', '雪', '雷', '零', '云', '雾', '霜', '霞', '需', '震', '露'] },
            { radical: '青', variants: [], meaning: 'green/blue', pinyin: 'qīng', chars: ['青', '清', '静', '情', '请'] },
            { radical: '非', variants: [], meaning: 'wrong/not', pinyin: 'fēi', chars: ['非', '罪', '悲'] },

            // 9+ stroke radicals
            { radical: '面', variants: [], meaning: 'face', pinyin: 'miàn', chars: ['面', '麵'] },
            { radical: '革', variants: [], meaning: 'leather/hide', pinyin: 'gé', chars: ['革', '靴', '鞋', '鞭'] },
            { radical: '韦', variants: [], meaning: 'tanned leather', pinyin: 'wéi', chars: ['韦', '韧'] },
            { radical: '韭', variants: [], meaning: 'leek', pinyin: 'jiǔ', chars: ['韭'] },
            { radical: '音', variants: [], meaning: 'sound', pinyin: 'yīn', chars: ['音', '韵', '章'] },
            { radical: '页', variants: [], meaning: 'page/head', pinyin: 'yè', chars: ['页', '顶', '项', '须', '顾', '领', '颜', '题', '额', '频'] },
            { radical: '风', variants: [], meaning: 'wind', pinyin: 'fēng', chars: ['风', '飘', '飞'] },
            { radical: '飞', variants: [], meaning: 'fly', pinyin: 'fēi', chars: ['飞'] },
            { radical: '食', variants: ['飠', '饣'], meaning: 'food/eat', pinyin: 'shí', chars: ['食', '饭', '饿', '馆', '饱', '饮', '饺', '馍', '馋', '养', '餐', '饼'] },
            { radical: '首', variants: [], meaning: 'head', pinyin: 'shǒu', chars: ['首', '道'] },
            { radical: '香', variants: [], meaning: 'fragrant', pinyin: 'xiāng', chars: ['香'] },

            // 10+ stroke radicals
            { radical: '马', variants: [], meaning: 'horse', pinyin: 'mǎ', chars: ['马', '驾', '骑', '验', '驱', '驻', '骂'] },
            { radical: '骨', variants: [], meaning: 'bone', pinyin: 'gǔ', chars: ['骨', '骼', '髓'] },
            { radical: '高', variants: ['髙'], meaning: 'tall/high', pinyin: 'gāo', chars: ['高'] },
            { radical: '髟', variants: [], meaning: 'long hair', pinyin: 'biāo', chars: ['髟', '髦'] },
            { radical: '斗', variants: [], meaning: 'fight', pinyin: 'dòu', chars: ['斗', '鬧'] },
            { radical: '鬯', variants: [], meaning: 'sacrificial wine', pinyin: 'chàng', chars: ['鬯'] },
            { radical: '鬲', variants: [], meaning: 'cauldron', pinyin: 'lì', chars: ['鬲'] },
            { radical: '鬼', variants: [], meaning: 'ghost/demon', pinyin: 'guǐ', chars: ['鬼', '魂', '魄', '魅'] },

            // 11+ stroke radicals
            { radical: '鱼', variants: [], meaning: 'fish', pinyin: 'yú', chars: ['鱼', '鲜', '鲸', '鲤', '鲨'] },
            { radical: '鸟', variants: [], meaning: 'bird', pinyin: 'niǎo', chars: ['鸟', '鸡', '鸭', '鹅', '鸽', '鹤', '鹦', '鹉', '鸦', '鸣', '鸭'] },
            { radical: '卤', variants: [], meaning: 'salt', pinyin: 'lǔ', chars: ['卤', '鹹'] },
            { radical: '鹿', variants: [], meaning: 'deer', pinyin: 'lù', chars: ['鹿', '麗', '麓'] },
            { radical: '麦', variants: [], meaning: 'wheat', pinyin: 'mài', chars: ['麦', '麵'] },
            { radical: '麻', variants: [], meaning: 'hemp', pinyin: 'má', chars: ['麻', '摩'] },

            // 12+ stroke radicals
            { radical: '黄', variants: [], meaning: 'yellow', pinyin: 'huáng', chars: ['黄', '横'] },
            { radical: '黍', variants: [], meaning: 'millet', pinyin: 'shǔ', chars: ['黍', '黎'] },
            { radical: '黑', variants: [], meaning: 'black', pinyin: 'hēi', chars: ['黑', '默', '墨'] },
            { radical: '黹', variants: [], meaning: 'embroidery', pinyin: 'zhǐ', chars: ['黹'] },

            // 13+ stroke radicals
            { radical: '黾', variants: [], meaning: 'frog/toad', pinyin: 'mǐn', chars: ['黾'] },
            { radical: '鼎', variants: [], meaning: 'tripod', pinyin: 'dǐng', chars: ['鼎'] },
            { radical: '鼓', variants: [], meaning: 'drum', pinyin: 'gǔ', chars: ['鼓', '鼠'] },
            { radical: '鼠', variants: [], meaning: 'mouse/rat', pinyin: 'shǔ', chars: ['鼠', '鼻'] },

            // 14+ stroke radicals
            { radical: '鼻', variants: [], meaning: 'nose', pinyin: 'bí', chars: ['鼻'] },
            { radical: '齐', variants: [], meaning: 'even/together', pinyin: 'qí', chars: ['齐', '齢'] },

            // 15+ stroke radicals
            { radical: '齿', variants: [], meaning: 'tooth', pinyin: 'chǐ', chars: ['齿', '龄', '龋'] },

            // 16+ stroke radicals
            { radical: '龙', variants: [], meaning: 'dragon', pinyin: 'lóng', chars: ['龙', '龚'] },
            { radical: '龟', variants: [], meaning: 'turtle', pinyin: 'guī', chars: ['龟'] },
            { radical: '龠', variants: [], meaning: 'flute', pinyin: 'yuè', chars: ['龠'] }
        ];

        let currentQuestion = null;
        let score = 0;
        let total = 0;
        let answered = false;
        let mode = 'radical-meaning';
        let selectedOptionIndex = 0;

        const nextBtn = document.getElementById('nextBtn');
        const feedback = document.getElementById('feedback');

        function generateCharToRadicalQuestion() {
            const data = radicalData[Math.floor(Math.random() * radicalData.length)];
            const char = data.chars[Math.floor(Math.random() * data.chars.length)];

            // Determine which form of the radical to show (main or variant)
            const allRadicalForms = [data.radical, ...data.variants];

            currentQuestion = {
                type: 'char-to-radical',
                char: char,
                correctRadicalForms: allRadicalForms,
                primaryRadical: data.radical,
                meaning: data.meaning
            };

            document.getElementById('character').textContent = char;

            // Generate options: mix of main radicals and variants
            const wrongRadicals = [];
            const otherData = radicalData.filter(r => r !== data);

            while (wrongRadicals.length < 3) {
                const randomData = otherData[Math.floor(Math.random() * otherData.length)];
                // Randomly pick main radical or a variant
                const forms = [randomData.radical, ...randomData.variants];
                const randomForm = forms[Math.floor(Math.random() * forms.length)];

                if (!wrongRadicals.includes(randomForm) && !allRadicalForms.includes(randomForm)) {
                    wrongRadicals.push(randomForm);
                }
            }

            // Pick one correct form (could be main or variant)
            const correctForm = allRadicalForms[Math.floor(Math.random() * allRadicalForms.length)];
            const allOptions = [correctForm, ...wrongRadicals].sort(() => Math.random() - 0.5);

            const optionsContainer = document.getElementById('radicalOptions');
            optionsContainer.innerHTML = '';

            allOptions.forEach((radical, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = radical;
                btn.dataset.radical = radical;
                btn.dataset.index = index;
                btn.onclick = () => checkAnswer(radical, btn);
                optionsContainer.appendChild(btn);
            });

            selectedOptionIndex = 0;
            updateSelectedOption();
        }

        function generateRadicalToCharQuestion() {
            const data = radicalData[Math.floor(Math.random() * radicalData.length)];
            const correctChar = data.chars[Math.floor(Math.random() * data.chars.length)];

            // Randomly show main radical or variant
            const allForms = [data.radical, ...data.variants];
            const shownForm = allForms[Math.floor(Math.random() * allForms.length)];

            currentQuestion = {
                type: 'radical-to-char',
                radical: data.radical,
                correctChar: correctChar,
                meaning: data.meaning
            };

            document.getElementById('radical').textContent = shownForm;
            document.getElementById('radicalMeaning').textContent = `(${data.meaning})`;

            // Show variant info if showing a variant
            if (shownForm !== data.radical) {
                document.getElementById('radicalVariant').textContent = `[variant of ${data.radical}]`;
            } else {
                document.getElementById('radicalVariant').textContent = '';
            }

            // Generate options: correct char + chars from other radicals
            const wrongChars = [];
            const otherRadicals = radicalData.filter(r => r !== data);

            while (wrongChars.length < 3) {
                const randomData = otherRadicals[Math.floor(Math.random() * otherRadicals.length)];
                const randomChar = randomData.chars[Math.floor(Math.random() * randomData.chars.length)];
                if (!wrongChars.includes(randomChar)) {
                    wrongChars.push(randomChar);
                }
            }

            const allOptions = [correctChar, ...wrongChars].sort(() => Math.random() - 0.5);

            const optionsContainer = document.getElementById('charOptions');
            optionsContainer.innerHTML = '';

            allOptions.forEach((char, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = char;
                btn.dataset.char = char;
                btn.dataset.index = index;
                btn.onclick = () => checkAnswer(char, btn);
                optionsContainer.appendChild(btn);
            });

            selectedOptionIndex = 0;
            updateSelectedOption();
        }

        function generateRadicalMeaningQuestion() {
            const data = radicalData[Math.floor(Math.random() * radicalData.length)];

            // Randomly show main radical or variant
            const allForms = [data.radical, ...data.variants];
            const shownForm = allForms[Math.floor(Math.random() * allForms.length)];

            currentQuestion = {
                type: 'radical-meaning',
                radical: data.radical,
                correctMeaning: data.meaning,
                shownRadical: shownForm,
                pinyin: data.pinyin
            };

            const radicalElement = document.getElementById('radicalForMeaning');
            radicalElement.textContent = shownForm;

            // Add click handler for audio playback
            radicalElement.onclick = () => {
                playRadicalAudio(shownForm, data.pinyin);
            };

            // Show variant info if showing a variant
            if (shownForm !== data.radical) {
                document.getElementById('variantInfo').textContent = `[variant of ${data.radical}]`;
            } else {
                document.getElementById('variantInfo').textContent = '';
            }

            // Generate options: correct meaning + 3 random wrong meanings
            const wrongMeanings = radicalData
                .filter(r => r.meaning !== data.meaning)
                .sort(() => Math.random() - 0.5)
                .slice(0, 3)
                .map(r => r.meaning);

            const allOptions = [data.meaning, ...wrongMeanings].sort(() => Math.random() - 0.5);

            const optionsContainer = document.getElementById('meaningOptions');
            optionsContainer.innerHTML = '';

            allOptions.forEach((meaning, index) => {
                const btn = document.createElement('button');
                btn.className = 'option-btn';
                btn.textContent = meaning;
                btn.style.fontSize = '24px';
                btn.dataset.meaning = meaning;
                btn.dataset.index = index;
                btn.onclick = () => checkAnswer(meaning, btn);
                optionsContainer.appendChild(btn);
            });

            // Setup fuzzy input
            const meaningInput = document.getElementById('meaningInput');
            meaningInput.value = '';
            meaningInput.oninput = () => {
                const input = meaningInput.value.trim().toLowerCase();
                if (!input) {
                    document.querySelectorAll('#meaningOptions .option-btn').forEach(btn => {
                        btn.classList.remove('selected');
                    });
                    return;
                }

                let bestMatch = null;
                let bestScore = -1;

                allOptions.forEach((option, index) => {
                    const score = fuzzyMatch(input, option.toLowerCase());
                    if (score > bestScore) {
                        bestScore = score;
                        bestMatch = index;
                    }
                });

                document.querySelectorAll('#meaningOptions .option-btn').forEach((btn, idx) => {
                    if (idx === bestMatch) {
                        btn.classList.add('selected');
                    } else {
                        btn.classList.remove('selected');
                    }
                });
            };

            meaningInput.onkeydown = (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const selected = document.querySelector('#meaningOptions .option-btn.selected');
                    if (selected) {
                        selected.click();
                    }
                }
            };

            selectedOptionIndex = 0;
            updateSelectedOption();
            meaningInput.focus();
        }

        function playRadicalAudio(radical, pinyin) {
            // Use the existing playPinyinAudio function from utils.js
            playPinyinAudio(pinyin, radical);
        }

        function generateQuestion() {
            answered = false;
            feedback.textContent = '';
            feedback.className = 'feedback';

            if (mode === 'char-to-radical') {
                generateCharToRadicalQuestion();
            } else if (mode === 'radical-to-char') {
                generateRadicalToCharQuestion();
            } else if (mode === 'radical-meaning') {
                generateRadicalMeaningQuestion();
            }
        }

        function updateSelectedOption() {
            const buttons = document.querySelectorAll('.option-btn');
            buttons.forEach((btn, idx) => {
                if (idx === selectedOptionIndex) {
                    btn.classList.add('selected');
                } else {
                    btn.classList.remove('selected');
                }
            });
        }

        function selectOption(index) {
            const buttons = document.querySelectorAll('.option-btn');
            if (index >= 0 && index < buttons.length) {
                selectedOptionIndex = index;
                updateSelectedOption();
            }
        }

        function activateSelectedOption() {
            const buttons = document.querySelectorAll('.option-btn');
            if (selectedOptionIndex >= 0 && selectedOptionIndex < buttons.length) {
                buttons[selectedOptionIndex].click();
            }
        }

        function checkAnswer(answer, btnElement) {
            if (answered) return;

            answered = true;
            total++;

            let correct = false;
            let correctAnswer = '';

            if (currentQuestion.type === 'char-to-radical') {
                // Accept any form (main or variant)
                correct = currentQuestion.correctRadicalForms.includes(answer);
                correctAnswer = currentQuestion.primaryRadical;
            } else if (currentQuestion.type === 'radical-to-char') {
                correct = answer === currentQuestion.correctChar;
                correctAnswer = currentQuestion.correctChar;
            } else if (currentQuestion.type === 'radical-meaning') {
                correct = answer === currentQuestion.correctMeaning;
                correctAnswer = currentQuestion.correctMeaning;
            }

            if (correct) {
                playCorrectSound();
                score++;
                let feedbackText = `✓ Correct!`;
                // Show pinyin for radical meaning mode
                if (currentQuestion.type === 'radical-meaning' && currentQuestion.pinyin) {
                    feedbackText += ` (${currentQuestion.shownRadical} - ${currentQuestion.pinyin})`;
                    // Play audio after correct answer
                    playRadicalAudio(currentQuestion.shownRadical, currentQuestion.pinyin);
                }
                feedback.textContent = feedbackText;
                feedback.className = 'feedback correct';
                btnElement.classList.add('correct');
            } else {
                playWrongSound();
                let feedbackText = `✗ Wrong. The answer was: ${correctAnswer}`;
                // Show pinyin for radical meaning mode
                if (currentQuestion.type === 'radical-meaning' && currentQuestion.pinyin) {
                    feedbackText += ` (${currentQuestion.shownRadical} - ${currentQuestion.pinyin})`;
                    // Play audio after wrong answer
                    playRadicalAudio(currentQuestion.shownRadical, currentQuestion.pinyin);
                }
                feedback.textContent = feedbackText;
                feedback.className = 'feedback incorrect';
                btnElement.classList.add('incorrect');

                // Highlight correct answer
                document.querySelectorAll('.option-btn').forEach(btn => {
                    const btnValue = btn.dataset.radical || btn.dataset.char || btn.dataset.meaning;

                    // For char-to-radical mode, accept any correct form
                    if (currentQuestion.type === 'char-to-radical') {
                        if (currentQuestion.correctRadicalForms.includes(btnValue)) {
                            btn.classList.add('correct');
                        }
                    } else {
                        if (btnValue === correctAnswer) {
                            btn.classList.add('correct');
                        }
                    }
                });
            }

            updateStats();

            // Disable all buttons
            document.querySelectorAll('.option-btn').forEach(btn => {
                btn.disabled = true;
                btn.style.cursor = 'not-allowed';
            });

            // Auto-advance to next question
            setTimeout(() => {
                generateQuestion();
            }, correct ? 800 : 1500);
        }

        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('total').textContent = total;
            const percentage = total > 0 ? Math.round((score / total) * 100) : 0;
            document.getElementById('percentage').textContent = percentage;
        }

        // Keyboard navigation
        document.addEventListener('keydown', (e) => {
            // Don't intercept keys if user is typing in an input field
            if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                return;
            }

            if (!answered) {
                if (e.key === 'h') {
                    e.preventDefault();
                    // Move left
                    if (selectedOptionIndex === 1) selectOption(0);
                    else if (selectedOptionIndex === 3) selectOption(2);
                } else if (e.key === 'l') {
                    e.preventDefault();
                    // Move right
                    if (selectedOptionIndex === 0) selectOption(1);
                    else if (selectedOptionIndex === 2) selectOption(3);
                } else if (e.key === 'k') {
                    e.preventDefault();
                    // Move up
                    if (selectedOptionIndex === 2) selectOption(0);
                    else if (selectedOptionIndex === 3) selectOption(1);
                } else if (e.key === 'j') {
                    e.preventDefault();
                    // Move down
                    if (selectedOptionIndex === 0) selectOption(2);
                    else if (selectedOptionIndex === 1) selectOption(3);
                } else if (e.key === 'Enter') {
                    e.preventDefault();
                    activateSelectedOption();
                } else if (e.key >= '1' && e.key <= '4') {
                    e.preventDefault();
                    const index = parseInt(e.key) - 1;
                    selectOption(index);
                    activateSelectedOption();
                }
            }
        });

        nextBtn.addEventListener('click', generateQuestion);

        // Mode selector
        document.querySelectorAll('.mode-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.mode-btn').forEach(b => {
                    b.classList.remove('active');
                    b.classList.remove('bg-blue-500', 'text-white', 'border-blue-500');
                    b.classList.add('border-gray-300', 'hover:bg-gray-100');
                });

                btn.classList.add('active');
                btn.classList.remove('border-gray-300', 'hover:bg-gray-100');
                btn.classList.add('bg-blue-500', 'text-white', 'border-blue-500');

                mode = btn.dataset.mode;

                // Hide all modes
                document.getElementById('charToRadicalMode').style.display = 'none';
                document.getElementById('radicalToCharMode').style.display = 'none';
                document.getElementById('radicalMeaningMode').style.display = 'none';

                // Show selected mode
                if (mode === 'char-to-radical') {
                    document.getElementById('charToRadicalMode').style.display = 'block';
                } else if (mode === 'radical-to-char') {
                    document.getElementById('radicalToCharMode').style.display = 'block';
                } else if (mode === 'radical-meaning') {
                    document.getElementById('radicalMeaningMode').style.display = 'block';
                }

                generateQuestion();
            });
        });

        // Start first question
        generateQuestion();
    </script>
</body>
</html>
