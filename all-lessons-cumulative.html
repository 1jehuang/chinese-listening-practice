<!DOCTYPE html>
<html lang="zh-CN" translate="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google" content="notranslate">
    <title>All Lessons Cumulative - Quiz</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/hanzi-writer@3.5/dist/hanzi-writer.min.js"></script>
    <link rel="stylesheet" href="css/common.css">
    <script src="js/utils.js"></script>
    <script src="js/command-palette.js"></script>
    <script src="js/etymology-loader.js"></script>
    <script src="js/pinyin-utils.js"></script>
    <script src="js/spaced-repetition.js"></script>
    <script src="js/quiz-engine.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-sync.js"></script>
</head>
<body class="bg-gray-100 min-h-screen">
    <a href="home.html" class="fixed top-4 left-4 bg-white hover:bg-gray-100 text-gray-700 px-3 py-2 rounded-lg shadow border border-gray-200 transition text-sm z-50">‚Üê Home</a>

    <div class="flex min-h-screen">
        <!-- Mode Selector Sidebar -->
        <div class="w-64 bg-white shadow-lg p-4 overflow-y-auto">
            <h2 class="text-lg font-bold text-gray-800 mb-4 mt-12">Quiz Modes</h2>
            <div class="flex flex-col gap-2">
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition active:bg-blue-500 active:text-white active:border-blue-500 text-left text-sm" data-mode="char-to-pinyin">Char ‚Üí Pinyin</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="char-to-pinyin-type">Char ‚Üí Pinyin (MC)</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="char-to-pinyin-tones-mc">Char ‚Üí Pinyin (Tones MC)</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="char-to-tones">Char ‚Üí Tones</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="audio-to-pinyin">Audio ‚Üí Pinyin</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="pinyin-to-char">Pinyin ‚Üí Char</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="char-to-meaning-type">Char ‚Üí Meaning</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="audio-to-meaning">Audio ‚Üí Meaning</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="meaning-to-char">Meaning ‚Üí Char</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="stroke-order">Stroke Order</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="handwriting">Handwriting</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="draw-char">Draw Character</button>
                <button class="mode-btn px-3 py-2 rounded-lg border-2 border-gray-300 hover:bg-gray-100 transition text-left text-sm" data-mode="study">Study Mode</button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-4 md:p-8">
            <div class="max-w-3xl mx-auto bg-white rounded-xl shadow-lg p-6 md:p-8">
                <h1 class="text-3xl font-bold text-center mb-6 text-gray-800">All Lessons Cumulative (Lessons 1-7)</h1>

                <!-- Question Display -->
                <div id="questionDisplay" class="text-center"></div>

                <!-- Upcoming Preview (below question) -->
                <div id="upcomingCharacters" class="hidden text-center mt-4">
                    <div class="preview-list flex justify-center gap-4 text-4xl text-gray-300"></div>
                    <div class="text-xs uppercase tracking-widest text-gray-400 mt-2">Upcoming</div>
                </div>

                <!-- Hint -->
                <div id="hint" class="text-center text-2xl font-semibold my-4"></div>

                <!-- Audio Section -->
                <div id="audioSection" class="text-center my-4 hidden">
                    <button id="playAudioBtn" class="bg-cyan-500 hover:bg-cyan-600 text-white px-6 py-3 rounded-lg transition">üîä Play Sound</button>
                </div>

                <!-- Type Mode -->
                <div id="typeMode" class="space-y-4">
                    <input type="text" id="answerInput" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg" placeholder="Type your answer...">
                    <button id="checkBtn" class="w-full bg-green-500 hover:bg-green-600 text-white px-6 py-3 rounded-lg font-semibold transition">Check Answer</button>
                </div>

                <!-- Choice Mode -->
                <div id="choiceMode" class="hidden">
                    <div id="options" class="grid grid-cols-2 gap-3"></div>
                </div>

                <!-- Fuzzy Mode -->
                <div id="fuzzyMode" class="hidden space-y-4">
                    <input type="text" id="fuzzyInput" class="w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-blue-500 focus:outline-none text-lg" placeholder="Type your answer...">
                    <div id="fuzzyOptions" class="grid grid-cols-2 gap-3"></div>
                </div>

                <!-- Stroke Order Mode -->
                <div id="strokeOrderMode" class="hidden">
                    <div id="strokeOrderWriter" class="flex justify-center my-8"></div>
                </div>

                <!-- Handwriting Mode -->
                <div id="handwritingMode" class="hidden">
                    <div class="text-center text-gray-600 mb-4">Practice writing on paper, then reveal the answer</div>
                    <div class="text-center text-sm text-gray-500 mb-2">üí° Audio will play for each character as it appears</div>
                    <div id="handwritingWriter" class="flex justify-center my-8"></div>
                    <div class="flex justify-center gap-3">
                        <button id="hwShowBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-8 py-3 rounded-lg transition text-lg">Show Answer / Replay</button>
                        <button id="hwNextBtn" class="bg-green-500 hover:bg-green-600 text-white px-8 py-3 rounded-lg transition text-lg">Next</button>
                    </div>
                </div>

                <!-- Draw Character Mode -->
                <div id="drawCharMode" class="hidden">
                    <div class="text-center mb-4">
                        <div id="ocrResult" class="text-6xl min-h-[80px] text-blue-600 font-bold"></div>
                        <div class="text-sm text-gray-500">Real-time recognition</div>
                    </div>
                    <canvas id="drawCanvas" class="border-2 border-gray-300 rounded-lg mx-auto cursor-crosshair" width="300" height="300"></canvas>
                    <div class="flex gap-3 justify-center mt-4">
                        <button id="clearCanvasBtn" class="bg-red-500 hover:bg-red-600 text-white px-6 py-2 rounded-lg transition">üóëÔ∏è Clear</button>
                        <button id="submitDrawBtn" class="bg-green-500 hover:bg-green-600 text-white px-6 py-2 rounded-lg transition">‚úì Submit</button>
                        <button id="fullscreenDrawBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-6 py-2 rounded-lg transition">‚õ∂ Fullscreen</button>
                    </div>
                </div>

                <!-- Fullscreen Drawing Mode -->
                <div id="fullscreenDrawContainer" class="hidden fixed inset-0 bg-gray-100 z-50 flex flex-col">
                    <div class="flex justify-between items-center p-4 bg-white shadow">
                        <div class="text-2xl font-bold text-gray-700" id="fullscreenPrompt">Draw: </div>
                        <div class="flex gap-2">
                            <button id="fullscreenUndoBtn" class="bg-gray-300 text-gray-500 px-4 py-2 rounded-lg transition cursor-not-allowed" disabled>‚Ü∂ Undo</button>
                            <button id="fullscreenRedoBtn" class="bg-gray-300 text-gray-500 px-4 py-2 rounded-lg transition cursor-not-allowed" disabled>‚Ü∑ Redo</button>
                            <button id="fullscreenClearBtn" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition">üóëÔ∏è Clear</button>
                            <button id="fullscreenSubmitBtn" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition">‚úì Submit</button>
                            <button id="fullscreenShowAnswerBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition">üí° Answer</button>
                            <button id="fullscreenNextBtn" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition">‚Üí Next</button>
                            <button id="exitFullscreenBtn" class="bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition">‚úï Exit</button>
                        </div>
                    </div>
                    <div class="flex-1 flex items-center justify-center p-4">
                        <div class="text-center w-full h-full flex flex-col items-center justify-center">
                            <div id="fullscreenOcrResult" class="text-7xl sm:text-8xl min-h-[100px] text-blue-600 font-bold mb-4"></div>
                            <canvas id="fullscreenDrawCanvas" class="border-4 border-gray-400 rounded-lg cursor-crosshair bg-white shadow-lg max-w-full max-h-full" style="aspect-ratio: 1/1;"></canvas>
                        </div>
                    </div>
                </div>

                <!-- Study Mode -->
                <div id="studyMode" class="hidden">
                    <div class="text-center text-gray-600 mb-4">Study all vocabulary with audio</div>
                    <div id="studyList" class="space-y-2 max-h-[600px] overflow-y-auto"></div>
                </div>

                <!-- Feedback -->
                <div id="feedback" class="text-center text-2xl font-semibold my-4 min-h-[24px]"></div>

                <!-- Stats -->
                <div id="stats" class="flex justify-between text-sm text-gray-600 pt-4 border-t border-gray-200">
                    <span>Score: <span id="score" class="font-semibold">0</span>/<span id="total" class="font-semibold">0</span></span>
                    <span>Accuracy: <span id="accuracy" class="font-semibold">0%</span></span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Lesson 1: Two Maps (‰∏§Âº†Âú∞Âõæ)
        const lesson1 = [
            { char: 'Á¨¨', pinyin: 'd√¨', meaning: 'ordinal prefix (-st, -nd, -rd, -th)' },
            { char: 'ËØæ', pinyin: 'k√®', meaning: 'lesson' },
            { char: '‰∏§', pinyin: 'li«éng', meaning: 'two (used with AN)' },
            { char: 'Âº†', pinyin: 'zhƒÅng', meaning: 'measure word for flat things' },
            { char: 'Âú∞Âõæ', pinyin: 'd√¨t√∫', meaning: 'map' },
            { char: 'Áî≤', pinyin: 'ji«é', meaning: 'person A' },
            { char: 'Ëøô', pinyin: 'zh√®', meaning: 'this; these' },
            { char: 'ÊòØ', pinyin: 'sh√¨', meaning: 'is; am; are' },
            { char: '‰ªÄ‰πà', pinyin: 'sh√©n.me', meaning: 'what' },
            { char: 'ÊØî', pinyin: 'b«ê', meaning: 'compare' },
            { char: 'Â§ß', pinyin: 'd√†', meaning: 'big' },
            { char: '‰∏ÄÁÇπÂÑø', pinyin: 'y√¨di«énr', meaning: 'a little' },
            { char: 'Âπ¥', pinyin: 'ni√°n', meaning: 'year' },
            { char: '‰ª•Ââç', pinyin: 'y«êqi√°n', meaning: 'before' },
            { char: 'ÈÇ£Êó∂', pinyin: 'n√†sh√≠', meaning: 'that time' },
            { char: 'Ëøò', pinyin: 'h√°i', meaning: 'still; also' },
            { char: 'ÂåÖÊã¨', pinyin: 'bƒÅoku√≤', meaning: 'include' },
            { char: 'Áé∞Âú®', pinyin: 'xi√†nz√†i', meaning: 'now' },
            { char: 'ËíôÂè§ÂõΩ', pinyin: 'Mƒõngg«îgu√≥', meaning: 'Mongolia' },
            { char: 'Âì¶', pinyin: '√≤', meaning: 'oh; I see' },
            { char: 'Êàë', pinyin: 'w«í', meaning: 'I; me' },
            { char: 'ÊáÇ', pinyin: 'd«íng', meaning: 'understand' },
            { char: '‰∫Ü', pinyin: 'le', meaning: 'particle for new situation' },
            { char: 'ÂéÜÂè≤', pinyin: 'l√¨.sh«ê', meaning: 'history' },
            { char: '‰∏ä', pinyin: 'sh√†ng', meaning: 'in; on' },
            { char: 'ÂØπ‰∫Ü', pinyin: 'du√¨.le', meaning: "that's right" },
            { char: 'ÂèØÊòØ', pinyin: 'kƒõ.sh√¨', meaning: 'however; but' },
            { char: 'ÂÆåÂÖ®', pinyin: 'w√°nqu√°n', meaning: 'completely; entirely' },
            { char: '‰ªñ‰ª¨', pinyin: 'tƒÅ.men', meaning: 'they' },
            { char: 'Êê¨', pinyin: 'bƒÅn', meaning: 'move' },
            { char: 'Âà∞‚Ä¶Âéª', pinyin: 'd√†o...q√π', meaning: 'go to...' },
            { char: 'Âè∞Êπæ', pinyin: 'T√°iwƒÅn', meaning: 'Taiwan' },
            { char: 'Â∞±ÊòØ', pinyin: 'ji√π.sh√¨', meaning: 'be exactly' },
            { char: 'Âíå', pinyin: 'h√©', meaning: 'and' },
            { char: 'ÊîøÂ∫ú', pinyin: 'zh√®ng.f«î', meaning: 'government' },
            { char: 'ÈÉΩ', pinyin: 'd≈çu', meaning: 'in all cases' },
            { char: 'ËØ¥', pinyin: 'shu≈ç', meaning: 'speak; say; talk' },
            { char: 'Âè™Êúâ', pinyin: 'zh«êy«íu', meaning: "there's only" },
            { char: '‰∏™', pinyin: 'g√®', meaning: 'general measure word' },
            { char: 'ËÄå', pinyin: '√©r', meaning: 'and; yet' },
            { char: 'ÈÉ®ÂàÜ', pinyin: 'b√π.f√®n', meaning: 'part' },
            { char: 'ÂõΩÂÆ∂', pinyin: 'gu√≥jiƒÅ', meaning: 'country' },
            { char: 'ÂØπ‰∏çÂØπ', pinyin: 'du√¨.bu.du√¨', meaning: 'Is it correct?' },
            { char: 'ÂæàÈöæËØ¥', pinyin: 'hƒõnn√°nshu≈ç', meaning: "It's hard to say" },
            { char: '‰πô', pinyin: 'y«ê', meaning: 'person B' },
            { char: '‰∏≠ÂõΩ', pinyin: 'Zh≈çng.gu√≥', meaning: 'China' },
            { char: 'ÈÇ£‰πà', pinyin: 'n√†.me', meaning: 'well then; then' },
            { char: 'ÈÇ£', pinyin: 'n√†', meaning: 'that; those' },
            { char: 'Âë¢', pinyin: 'ne', meaning: 'particle for follow-up questions' },
            { char: '‰πü', pinyin: 'yƒõ', meaning: 'also; too' },
            { char: '‰∏∫‰ªÄ‰πà', pinyin: 'w√®ish√©n.me', meaning: 'why' },
            { char: '‰∏ç', pinyin: 'b√π', meaning: 'no; not' },
            { char: '‰∏ÄÊ†∑', pinyin: 'yƒ´y√†ng', meaning: 'same' },
            { char: 'Âõ†‰∏∫', pinyin: 'yƒ´n.w√®i', meaning: 'because; since' },
            { char: '‰∏≠Âçé', pinyin: 'Zh≈çnghu√°', meaning: 'China' },
            { char: 'Ê∞ëÂõΩ', pinyin: 'm√≠ngu√≥', meaning: 'republic' },
            { char: '‰∫∫Ê∞ë', pinyin: 'r√©nm√≠n', meaning: 'the people' },
            { char: 'ÂÖ±ÂíåÂõΩ', pinyin: 'g√≤ngh√©gu√≥', meaning: 'republic' },
            { char: 'ÁöÑ', pinyin: 'de', meaning: 'particle for modification' }
        ];

        // Lesson 2: Where is My Home? (ÊàëÁöÑÂÆ∂Âú®Âì™ÂÑø?)
        const lesson2 = [
            { char: 'ÊàëÁöÑ', pinyin: 'w«í.de', meaning: 'my' },
            { char: 'ÂÆ∂', pinyin: 'jiƒÅ', meaning: 'home' },
            { char: 'Âú®', pinyin: 'z√†i', meaning: 'be located in; at; on' },
            { char: 'Âì™ÂÑø', pinyin: 'n«ér', meaning: 'where' },
            { char: 'Áà∂‰∫≤', pinyin: 'f√π.qin', meaning: 'father' },
            { char: '‰π¶', pinyin: 'sh≈´', meaning: 'book' },
            { char: '‰π¶Êàø', pinyin: 'sh≈´f√°ng', meaning: 'a study' },
            { char: 'Èáå', pinyin: 'l«ê', meaning: 'inside' },
            { char: 'ÊåÇ', pinyin: 'gu√†', meaning: 'hang' },
            { char: 'VÁùÄ', pinyin: 'V.zhe', meaning: 'keep on V-ing' },
            { char: 'Â∞è', pinyin: 'xi«éo', meaning: 'young; small' },
            { char: 'Êó∂ÂÄô', pinyin: 'sh√≠.hou', meaning: 'time' },
            { char: '‰ªñ', pinyin: 'tƒÅ', meaning: 'he' },
            { char: 'Â∏∏', pinyin: 'ch√°ng', meaning: 'often' },
            { char: 'Êåá', pinyin: 'zh«ê', meaning: 'point' },
            { char: 'Ë•øÂçó', pinyin: 'xƒ´n√°n', meaning: 'southwest' },
            { char: 'Ëæπ', pinyin: 'biƒÅn', meaning: 'side' },
            { char: 'Èªë', pinyin: 'hƒìi', meaning: 'black; dark' },
            { char: 'ÁÇπ', pinyin: 'di«én', meaning: 'spot; dot' },
            { char: 'Êàë‰ª¨ÁöÑ', pinyin: 'w«í.men.de', meaning: 'our; ours' },
            { char: 'ËÄÅÂÆ∂', pinyin: 'l«éojiƒÅ', meaning: 'hometown' },
            { char: 'ËßâÂæó', pinyin: 'ju√©.de', meaning: 'think; feel' },
            { char: 'Âæà', pinyin: 'hƒõn', meaning: 'very' },
            { char: 'Â•áÊÄ™', pinyin: 'q√≠gu√†i', meaning: 'strange' },
            { char: 'Á∫ΩÁ∫¶', pinyin: 'Ni«îyuƒì', meaning: 'New York' },
            { char: 'ÊÄé‰πà', pinyin: 'zƒõn.me', meaning: 'how; how come' },
            { char: '‰ºö', pinyin: 'hu√¨', meaning: 'could; would; can' },
            { char: 'ÂêéÊù•', pinyin: 'h√≤ul√°i', meaning: 'later' },
            { char: 'Êâç', pinyin: 'c√°i', meaning: 'later than expected' },
            { char: 'Áü•ÈÅì', pinyin: 'zhƒ´dao', meaning: 'know' },
            { char: 'ÊàêÈÉΩ', pinyin: 'Ch√©ngd≈´', meaning: 'name of a city' },
            { char: 'ËôΩÁÑ∂', pinyin: 'suƒ´r√°n', meaning: 'although' },
            { char: 'Êù•', pinyin: 'l√°i', meaning: 'come' },
            { char: 'ÁæéÂõΩ', pinyin: 'Mƒõigu√≥', meaning: 'The United States of America' },
            { char: 'Âø´‚Ä¶‰∫Ü', pinyin: 'ku√†i... .le', meaning: 'almost, about to' },
            { char: 'ÊÄª', pinyin: 'z«íng', meaning: 'always' },
            { char: 'ËøòÊòØ', pinyin: 'h√°i.sh√¨', meaning: 'still' },
            { char: 'ÂõõÂ∑ù', pinyin: 'S√¨chuƒÅn', meaning: 'a province in southwest China' },
            { char: 'Áîü', pinyin: 'shƒìng', meaning: 'be born' },
            { char: 'Èïø', pinyin: 'zh«éng', meaning: 'grow up' },
            { char: '‰ªéÂ∞è', pinyin: 'c√≥ngxi«éo', meaning: 'from one\'s childhood' },
            { char: 'Â∞±', pinyin: 'ji√π', meaning: 'sooner than expected; as early as' },
            { char: 'Ë∑ü', pinyin: 'gƒìn', meaning: 'with; to' },
            { char: '‰∏≠Êñá', pinyin: 'Zh≈çngw√©n', meaning: 'the Chinese language' },
            { char: 'ÂêÉ', pinyin: 'chƒ´', meaning: 'eat' },
            { char: 'Ëèú', pinyin: 'c√†i', meaning: 'food; vegetables' },
            { char: 'ÊúâÊó∂', pinyin: 'y«íush√≠', meaning: 'sometimes' },
            { char: 'Áúã', pinyin: 'k√†n', meaning: 'see; look' },
            { char: 'ÁîµËßÜ', pinyin: 'di√†nsh√¨', meaning: 'television' },
            { char: 'ËäÇÁõÆ', pinyin: 'ji√©m√π', meaning: 'program' },
            { char: 'ÊòüÊúü', pinyin: 'xƒ´ngqƒ´', meaning: 'week' },
            { char: 'ÊòüÊúüÂÖ≠', pinyin: 'xƒ´ngqƒ´li√π', meaning: 'Saturday' },
            { char: 'Âéª', pinyin: 'q√π', meaning: 'go' },
            { char: 'ÈôÑËøë', pinyin: 'f√πj√¨n', meaning: 'nearby; vicinity' },
            { char: 'Â≠¶Ê†°', pinyin: 'xu√©xi√†o', meaning: 'school' },
            { char: 'Â≠¶', pinyin: 'xu√©', meaning: 'study; learn' },
            { char: 'ÂêåÂ≠¶', pinyin: 't√≥ngxu√©', meaning: 'classmates; schoolmates' },
            { char: 'Âà∞Â∫ï', pinyin: 'd√†od«ê', meaning: 'after all (emphatic use)' },
            { char: 'ÊÑèÊÄù', pinyin: 'y√¨si', meaning: 'meaning' }
        ];

        // Lesson 3: We Are All Americans (Êàë‰ª¨ÈÉΩÊòØÁæéÂõΩ‰∫∫)
        const lesson3 = [
            { char: '‰Ω†', pinyin: 'n«ê', meaning: 'you' },
            { char: '‰ªé‚Ä¶Êù•', pinyin: 'c√≥ng...l√°i', meaning: 'come from' },
            { char: 'Âæ∑Â∑û', pinyin: 'D√©zh≈çu', meaning: 'Texas' },
            { char: 'ÁúãËµ∑Êù•', pinyin: 'k√†n.qi.l√°i', meaning: 'look like, seem' },
            { char: 'ÂÉè', pinyin: 'xi√†ng', meaning: 'resemble' },
            { char: 'Âïä', pinyin: '.a', meaning: 'particle showing obviousness' },
            { char: 'Áúü', pinyin: 'zhƒìn', meaning: 'really' },
            { char: 'Áúã‰∏çÂá∫Êù•', pinyin: 'k√†n.b√π.ch≈´.l√°i', meaning: "can't figure out by looking; can't tell" },
            { char: 'Ê†∑', pinyin: 'y√†ng', meaning: 'kind; sort' },
            { char: 'ÊÉ≥', pinyin: 'xi«éng', meaning: 'think' },
            { char: 'ÈªÑ', pinyin: 'hu√°ng', meaning: 'yellow; brown' },
            { char: 'Â§¥Âèë', pinyin: 't√≥u.f√†', meaning: 'hair (on the human head)' },
            { char: 'Ëìù', pinyin: 'l√°n', meaning: 'blue' },
            { char: 'ÁúºÁùõ', pinyin: 'y«énjƒ´ng', meaning: 'eyes' },
            { char: 'Âêó', pinyin: '.ma', meaning: 'particle for simple questions' },
            { char: '‰∏ç‰∏ÄÂÆö', pinyin: 'b√πyƒ´d√¨ng', meaning: 'not necessarily' },
            { char: '‰ΩÜÊòØ', pinyin: 'd√†n.sh√¨', meaning: 'but' },
            { char: 'Êúâ', pinyin: 'y«íu', meaning: 'have; there be' },
            { char: 'Âç¥', pinyin: 'qu√®', meaning: 'but' },
            { char: 'Êó•Êú¨‰∫∫', pinyin: 'R√¨.bƒõn.r√©n', meaning: 'Japanese people' },
            { char: 'ÂèØ‰ª•', pinyin: 'kƒõy«ê', meaning: 'can; may' },
            { char: 'ÊâÄ‰ª•', pinyin: 'su«í.y«ê', meaning: 'therefore' },
            { char: 'ÊúâÁöÑ', pinyin: 'y«íu.de', meaning: 'some' },
            { char: 'ÁôΩ‰∫∫', pinyin: 'b√°i.r√©n', meaning: 'Caucasian American' },
            { char: 'Èªë‰∫∫', pinyin: 'hƒìi.r√©n', meaning: 'African American' },
            { char: 'ÈªÑÁßç‰∫∫', pinyin: 'hu√°ngzh«íng.r√©n', meaning: 'Asian American' },
            { char: 'Ê¨ßÊ¥≤', pinyin: '≈åuzh≈çu', meaning: 'Europe' },
            { char: 'ÈùûÊ¥≤', pinyin: 'Fƒìizh≈çu', meaning: 'Africa' },
            { char: '‰∫öÊ¥≤', pinyin: 'Y√†zh≈çu', meaning: 'Asia' },
            { char: 'Âè™Ë¶Å', pinyin: 'zh«êy√†o', meaning: 'as long as; provided that' },
            { char: 'Âæó', pinyin: 'dƒõi', meaning: 'have to' }
        ];

        // Lesson 4: Americans Study Chinese (ÁæéÂõΩ‰∫∫Â≠¶‰∏≠Êñá)
        const lesson4 = [
            { char: 'Â•≥', pinyin: 'n«ö', meaning: 'daughter; female' },
            { char: 'Â¶à', pinyin: 'mƒÅ', meaning: 'mom; mother' },
            { char: '‰ªäÂ§©', pinyin: 'jƒ´ntiƒÅn', meaning: 'today' },
            { char: 'Ê≥®ÂÜå', pinyin: 'zh√πc√®', meaning: 'register (at school)' },
            { char: 'ÈÄâ', pinyin: 'xu«én', meaning: 'choose' },
            { char: 'Èó®', pinyin: 'm√©n', meaning: 'measure word for courses' },
            { char: 'ÊØç', pinyin: 'm«î', meaning: 'mother (abbr.)' },
            { char: 'ËÆ®Âéå', pinyin: 't«éoy√†n', meaning: 'find disgusting; dislike' },
            { char: 'VËµ∑‚Ä¶Êù•', pinyin: 'V.q«ê.lai', meaning: 'start to V; set about V-ing' },
            { char: 'Âπ∂', pinyin: 'b√¨ng', meaning: 'actually (not); used for emphasis' },
            { char: 'Âè™ÊòØ', pinyin: 'zh«ê.sh√¨', meaning: 'only; just' },
            { char: 'ÂñúÊ¨¢', pinyin: 'x«êhuƒÅn', meaning: 'like' },
            { char: 'ÈÄº', pinyin: 'bƒ´', meaning: 'force; compel' },
            { char: 'Âæó', pinyin: '.de', meaning: 'predicative complement marker' },
            { char: 'Â§™', pinyin: 't√†i', meaning: 'too; excessively' },
            { char: 'Á¥ß', pinyin: 'j«ên', meaning: 'tight; strict' },
            { char: 'Ê≤°(Êúâ)', pinyin: 'm√©i(.y«íu)/m√©i y«íu/m√©iy«íu/mei2 you3/mei2you3', meaning: 'have not; there is not' },
            { char: 'Â•ΩÊûÅ‰∫Ü', pinyin: 'h«éoj√≠.le', meaning: 'wonderful; great' },
            { char: 'Áà∏Áà∏', pinyin: 'b√†.ba', meaning: 'father' },
            { char: 'Âê¨Âà∞', pinyin: 'tƒ´ng.d√†o', meaning: 'hear' },
            { char: 'Ê∂àÊÅØ', pinyin: 'xiƒÅo.xi', meaning: 'news; information' },
            { char: '‰∏ÄÂÆö', pinyin: 'y√≠d√¨ng', meaning: 'certainly; for sure' },
            { char: 'È´òÂÖ¥', pinyin: 'gƒÅox√¨ng', meaning: 'happy; glad' },
            { char: 'ÂëäËØâ', pinyin: 'g√†o.s√π', meaning: 'tell; inform' },
            { char: '‰Ω†ÂèàÊù•‰∫Ü', pinyin: 'n«ê y√≤u l√°i.le', meaning: 'there you go again' },
            { char: 'Ë¶Å', pinyin: 'y√†o', meaning: 'need; want' },
            { char: '‰∏ñÁïå', pinyin: 'sh√¨ji√®', meaning: 'world' },
            { char: 'ÂêÑ', pinyin: 'g√®', meaning: 'each; every' },
            { char: 'Âú∞', pinyin: 'd√¨', meaning: 'place; land' },
            { char: '‰∏ç‰ΩÜ', pinyin: 'b√πd√†n', meaning: 'not only' },
            { char: 'Ëã±ÂõΩ', pinyin: 'Yƒ´ng.gu√≥', meaning: 'England' },
            { char: 'Ê≥ïÂõΩ', pinyin: 'F«é.gu√≥', meaning: 'France' },
            { char: 'ÊòØÂêó', pinyin: 'sh√¨.ma', meaning: 'is that so?' },
            { char: '‰∫∫Âè£', pinyin: 'r√©n.k«íu', meaning: 'population' },
            { char: 'Â§ö', pinyin: 'du≈ç', meaning: 'many; much' },
            { char: 'ÁªèÊµé', pinyin: 'jƒ´ng.j√¨', meaning: 'economy' },
            { char: 'Ë¥∏Êòì', pinyin: 'm√†o.y√¨', meaning: 'trade; commerce' },
            { char: 'ÂèëËææ', pinyin: 'fƒÅ.d√°', meaning: 'developed; advanced' },
            { char: 'ÂÅö', pinyin: 'zu√≤', meaning: 'do; make' },
            { char: 'ÁîüÊÑè', pinyin: 'shƒìngyi', meaning: 'business' },
            { char: 'Ë∂äÊù•Ë∂ä', pinyin: 'yu√® l√°i yu√®', meaning: 'more and more' },
            { char: '‰∏ÄÂ§©ÊØî‰∏ÄÂ§©', pinyin: 'y√¨tiƒÅn b«ê y√¨tiƒÅn', meaning: 'day by day; more with each day' },
            { char: '‰∏∫‰∫Ü', pinyin: 'w√®ile', meaning: 'in order to' },
            { char: '‰π∞Âçñ', pinyin: 'm«éi.m√†i', meaning: 'business transaction; buying and selling' },
            { char: 'Âï∞', pinyin: 'lo', meaning: 'particle showing obviousness' },
            { char: '‰∏çËßÅÂæó', pinyin: 'b√∫ji√†n.de', meaning: 'not necessarily' },
            { char: 'ÊñáÂ≠¶', pinyin: 'w√©n.xu√©', meaning: 'literature' },
            { char: 'Ëá™Â∑±', pinyin: 'z√¨j«ê', meaning: 'self' },
            { char: 'Âàö', pinyin: 'gƒÅng', meaning: 'just now; recently' },
            { char: 'Êõ¥', pinyin: 'g√®ng', meaning: 'even more' },
            { char: 'ÊúâÊÑèÊÄù', pinyin: 'y«íu.y√¨.si', meaning: 'interesting; meaningful' }
        ];

        // Lesson 5: Am I from Sichuan? (ÊàëÊòØÂõõÂ∑ù‰∫∫Ôºü)
        const lesson5 = [
            { char: '‰∏äËØæ', pinyin: 'sh√†ngk√®', meaning: 'hold class; go to class' },
            { char: 'ËÄÅÂ∏à', pinyin: 'l«éoshƒ´', meaning: 'teacher' },
            { char: 'Âèà', pinyin: 'y√≤u', meaning: 'again' },
            { char: 'ÈóÆ', pinyin: 'w√®n', meaning: 'ask' },
            { char: 'ÊúâÊ≤°Êúâ', pinyin: 'y«íu m√©iy«íu', meaning: 'have or not? are there?' },
            { char: 'ÂêçÂ≠ó', pinyin: 'm√≠ng.zi', meaning: 'name' },
            { char: 'Âè´', pinyin: 'ji√†o', meaning: 'call; be called; tell' },
            { char: 'Â≠ó', pinyin: 'z√¨', meaning: 'Chinese character; word' },
            { char: 'ÂÜô', pinyin: 'xiƒõ', meaning: 'write' },
            { char: 'ÂõûÁ≠î', pinyin: 'hu√≠d√°', meaning: 'answer; respond' },
            { char: '‰∏çÂ•ΩÊÑèÊÄù', pinyin: 'b√πh«éoy√¨.si', meaning: 'embarrassing' },
            { char: 'Âá∫Áîü', pinyin: 'ch≈´shƒìng', meaning: 'be born' },
            { char: 'Áªô', pinyin: 'gƒõi', meaning: 'for; to/give' },
            { char: 'Ëµ∑ÂêçÂ≠ó', pinyin: 'q«ê m√≠ng.zi', meaning: 'give a name; pick a name' },
            { char: 'Âπø‰∏ú‰∫∫', pinyin: 'gu«éngd≈çngr√©n', meaning: 'Cantonese people' },
            { char: 'ËØ¥Ê≥ï', pinyin: 'shu≈ç.fa', meaning: 'way of saying; opinion' },
            { char: 'ÁÖß‚Ä¶ÁöÑËØ¥Ê≥ï', pinyin: 'zh√†o...de shu≈ç.fa', meaning: "according to...'s opinion" },
            { char: 'Â≠©Â≠ê', pinyin: 'h√°i.zi', meaning: 'child' },
            { char: 'Ëøû', pinyin: 'li√°n', meaning: 'even' },
            { char: 'ËÉΩ', pinyin: 'n√©ng', meaning: 'can; may; could' },
            { char: 'ÁÆó(ÊòØ)', pinyin: 'su√†n(.shi)', meaning: 'be considered' },
            { char: 'Ëøá', pinyin: 'gu√≤', meaning: 'verbal suffix for past experience' },
            { char: '‰∏çËøá', pinyin: 'b√∫gu√≤', meaning: 'but; however' },
            { char: 'ÁîµËØù', pinyin: 'di√†nhu√†', meaning: 'phone call; telephone' },
            { char: 'ËøõÊù•', pinyin: 'j√¨nl√°i', meaning: 'come in' },
            { char: 'ÊòéÂ§©', pinyin: 'm√≠ngtiƒÅn', meaning: 'tomorrow' },
            { char: 'ÂÜç', pinyin: 'z√†i', meaning: 'again' },
            { char: 'ÊÇ®', pinyin: 'n√≠n', meaning: 'you (a respectful form)' },
            { char: 'Êâì', pinyin: 'd«é', meaning: 'dial or call (on phone)' }
        ];

        // Lesson 6: Don't Worry (Âà´ÊãÖÂøÉ)
        const lesson6 = [
            { char: 'Âà´', pinyin: 'bi√©', meaning: 'don\'t' },
            { char: 'ÊãÖÂøÉ', pinyin: 'dƒÅnxƒ´n', meaning: 'worry' },
            { char: 'ÈìÉ', pinyin: 'l√≠ng', meaning: 'bell' },
            { char: 'Â£∞(Èü≥)', pinyin: 'shƒìng(yƒ´n)', meaning: 'sound' },
            { char: 'ÂΩïÈü≥', pinyin: 'l√πyƒ´n', meaning: '(telephone) recording; record (sound)' },
            { char: 'Â±ãÂ≠ê', pinyin: 'w≈´.zi', meaning: 'room' },
            { char: 'Ê≤°Ê≥ï', pinyin: 'm√©i.f«é', meaning: 'no way; can\'t' },
            { char: 'Êé•ÁîµËØù', pinyin: 'jiƒì di√†nhu√†', meaning: 'answer phone calls' },
            { char: 'ËØ∑', pinyin: 'q«êng', meaning: 'please; request' },
            { char: 'Áïô‰∏ã', pinyin: 'li√∫xi√†', meaning: 'leave (message, etc.); stay (behind)' },
            { char: 'Âè∑Á†Å', pinyin: 'h√†om«é', meaning: 'number' },
            { char: 'ÂõûÊù•', pinyin: 'hu√≠l√°i', meaning: 'come back; return' },
            { char: 'ÂõûÁîµËØù', pinyin: 'hu√≠ di√†nhu√†', meaning: 'call back' },
            { char: 'Êï¥Â§©', pinyin: 'zhƒõngtiƒÅn', meaning: 'all day long; always' },
            { char: 'Âøô', pinyin: 'm√°ng', meaning: 'busy' },
            { char: '‰∫õ', pinyin: 'xiƒì', meaning: '"plural" measure word' },
            { char: '‰∏ãÊ¨°', pinyin: 'xi√†c√¨', meaning: 'next time' },
            { char: 'Ê¨°', pinyin: 'c√¨', meaning: 'AN for time; instance' },
            { char: 'Â•π', pinyin: 'tƒÅ', meaning: 'she; her' },
            { char: 'Áî∑ÊúãÂèã', pinyin: 'n√°np√©ng.you', meaning: 'boyfriend' },
            { char: 'Âá†', pinyin: 'j«ê', meaning: 'several; a few' },
            { char: '‰ø°', pinyin: 'x√¨n', meaning: 'believe' },
            { char: '‰∏äÊ¨°', pinyin: 'sh√†ngc√¨', meaning: 'last time' },
            { char: 'ÂõûÂÆ∂', pinyin: 'hu√≠jiƒÅ', meaning: 'go home; return home' },
            { char: '‰Ωè', pinyin: 'zh√π', meaning: 'stay; live' },
            { char: 'Â§©', pinyin: 'tiƒÅn', meaning: 'day' },
            { char: 'Áî∑ÁöÑ', pinyin: 'n√°n.de', meaning: 'male; man' },
            { char: 'Â•ΩÂá†', pinyin: 'h«éoj«ê', meaning: 'quite a few' },
            { char: 'Âè™', pinyin: 'zh«ê', meaning: 'only; just' },
            { char: '‰∫ã', pinyin: 'sh√¨', meaning: 'things; matters; business' },
            { char: '‰ΩïÂøÖ', pinyin: 'h√©b√¨', meaning: 'why must? why bother?' },
            { char: '‰∏∫‚Ä¶ÊìçÂøÉ', pinyin: 'w√©i...cƒÅoxƒ´n', meaning: 'worry for' },
            { char: 'Âà´ÁöÑ', pinyin: 'bi√©.de', meaning: 'other (things)' },
            { char: 'ÊÄÄÂ≠ï', pinyin: 'hu√°iy√πn', meaning: 'be pregnant' },
            { char: 'Âøµ‰π¶', pinyin: 'ni√†nsh≈´', meaning: 'study' },
            { char: 'ÊîæÂøÉ', pinyin: 'f√†ngxƒ´n', meaning: 'don\'t worry; put down the heart' },
            { char: 'ÈÅøÂ≠ï', pinyin: 'b√¨y√πn', meaning: 'avoid pregnancy; practice birth control' },
            { char: 'ÈöæÈÅì', pinyin: 'n√°nd√†o', meaning: 'do you mean to say that...?' },
            { char: 'Ë¶ÅÊòØ', pinyin: 'y√†oshi', meaning: 'if' },
            { char: 'Â´Å', pinyin: 'ji√†', meaning: 'marry (a man)' },
            { char: 'Â§ñÂõΩ‰∫∫', pinyin: 'w√†igu√≥r√©n', meaning: 'foreigner' },
            { char: 'ÊÄé‰πàÂäû', pinyin: 'zƒõn.me b√†n', meaning: 'what to do? what can be done?' },
            { char: 'Ë∞Å', pinyin: 'sh√©i', meaning: 'who' }
        ];

        // Lesson 7: Living Together (Áî∑Â•≥Âêå‰Ωè)
        const lesson7part1 = [
            { char: 'Âêå‰Ωè', pinyin: 't√≥ngzh√π', meaning: 'live together' },
            { char: '‰ªé‚Ä¶Ëµ∑', pinyin: 'c√≥ng...q«ê', meaning: 'starting from' },
            { char: 'Â≠¶Êúü', pinyin: 'xu√©qƒ´', meaning: 'semester' },
            { char: 'ÂÖ¨ÂØì', pinyin: 'g≈çngy√π', meaning: 'apartment' },
            { char: 'ÂÆøËàç', pinyin: 's√πsh√®', meaning: 'dormitory' },
            { char: 'Êñπ‰æø', pinyin: 'fƒÅngbi√†n', meaning: 'convenient' },
            { char: 'Êê¨Âá∫Âéª', pinyin: 'bƒÅn ch≈´.q√π', meaning: 'move out' },
            { char: 'ÂêÉÈ•≠', pinyin: 'chƒ´f√†n', meaning: 'eat' },
            { char: 'ÈóÆÈ¢ò', pinyin: 'w√®nt√≠', meaning: 'problem; question' },
            { char: 'Âé®Êàø', pinyin: 'ch√∫f√°ng', meaning: 'kitchen' },
            { char: 'È£üÂ†Ç', pinyin: 'sh√≠t√°ng', meaning: 'cafeteria; canteen' },
            { char: 'Ë¥µ', pinyin: 'gu√¨', meaning: 'expensive' },
            { char: 'Â•ΩÂêÉ', pinyin: 'h«éochƒ´', meaning: 'tasty; delicious' },
            { char: 'ÊØèÂ§©', pinyin: 'mƒõitiƒÅn', meaning: 'every day' },
            { char: 'Âèó‰∏ç‰∫Ü', pinyin: 'sh√≤u.bu.li«éo', meaning: "can't stand; intolerable" },
            { char: 'ÊåëÂâî', pinyin: 'tiƒÅo.ti', meaning: 'nitpicky; fastidious' },
            { char: 'ÂäüËØæ', pinyin: 'g≈çngk√®', meaning: 'schoolwork; homework' },
            { char: 'Êó∂Èó¥', pinyin: 'sh√≠jiƒÅn', meaning: 'time' },
            { char: '‰π∞', pinyin: 'm«éi', meaning: 'buy' },
            { char: 'ËΩÆÊµÅ', pinyin: 'l√∫nli√∫', meaning: 'take turns' },
            { char: 'ÊôöÈ•≠', pinyin: 'w«énf√†n', meaning: 'dinner' },
            { char: 'Êó©È•≠', pinyin: 'z«éof√†n', meaning: 'breakfast' },
            { char: '‰∏≠È•≠', pinyin: 'zh≈çngf√†n', meaning: 'lunch' },
            { char: '‰∏âÊòéÊ≤ª', pinyin: 'sƒÅnm√≠ngzh√¨', meaning: 'sandwich' },
            { char: 'ÁÆÄÂçï', pinyin: 'ji«éndƒÅn', meaning: 'simple' }
        ];

        const lesson7part2 = [
            { char: 'ÂÆπÊòì', pinyin: 'r√≥ngy√¨', meaning: 'easy' },
            { char: 'ÂèØ', pinyin: 'kƒõ', meaning: 'indeed; (for emphasis)' },
            { char: 'ÂÜ≥ÂÆö', pinyin: 'ju√©d√¨ng', meaning: 'decide' },
            { char: 'Â∏¶', pinyin: 'd√†i', meaning: 'bring; take' },
            { char: 'Áî®ÂÖ∑', pinyin: 'y√≤ngj√π', meaning: 'utensil; appliance' },
            { char: 'ÂæÆÊ≥¢ÁÇâ', pinyin: 'wƒìib≈çl√∫', meaning: 'microwave oven' },
            { char: 'Ë°å', pinyin: 'x√≠ng', meaning: 'all right; OK; no problem' },
            { char: 'Â•Ω‰πÖ', pinyin: 'h«éoji«î', meaning: 'for a long time' },
            { char: 'Áî®', pinyin: 'y√≤ng', meaning: 'use' },
            { char: 'Âùè‰∫Ü', pinyin: 'hu√†i.le', meaning: 'be broken' },
            { char: 'ÂÆ∂ÂÖ∑', pinyin: 'jiƒÅj√π', meaning: 'furniture' },
            { char: 'Â∫ä', pinyin: 'chu√°ng', meaning: 'bed' },
            { char: 'Ê°åÂ≠ê', pinyin: 'zhu≈ç.zi', meaning: 'table' },
            { char: '‰π¶Êû∂', pinyin: 'sh≈´ji√†', meaning: 'bookshelf' },
            { char: 'Êää', pinyin: 'b«é', meaning: 'AN for things with a handle' },
            { char: 'Ê§ÖÂ≠ê', pinyin: 'y«ê.zi', meaning: 'chair' },
            { char: 'Âè∞ÁÅØ', pinyin: 't√°idƒìng', meaning: 'desk lamp' },
            { char: 'Âú∞ÊØØ', pinyin: 'd√¨t«én', meaning: 'rug; carpet' },
            { char: 'Ë¶ÅÁ¥ß', pinyin: 'y√†oj«ên', meaning: 'important; serious' },
            { char: 'Âêà‰Ωè', pinyin: 'h√©zh√π', meaning: 'share living space' },
            { char: 'ËÆ§ËØÜ', pinyin: 'r√®n.shi', meaning: 'know (a person); recognize' },
            { char: 'Âπ¥Á∫ß', pinyin: 'ni√°nj√≠', meaning: 'school grade; year' },
            { char: '‰∏ÄËµ∑', pinyin: 'y√¨q«ê', meaning: 'together' },
            { char: '‰∏çÂ§™', pinyin: 'b√πt√†i', meaning: 'not very' },
            { char: 'Êµ¥ÂÆ§', pinyin: 'y√πsh√¨', meaning: 'bathroom' },
            { char: 'ÂéïÊâÄ', pinyin: 'c√®su«í', meaning: 'toilet' },
            { char: 'ÂêàÁî®', pinyin: 'h√©y√≤ng', meaning: 'share (use together)' },
            { char: 'ÊúÄÂ•Ω', pinyin: 'zu√¨h«éo', meaning: 'had better' },
            { char: 'ËÄÉËôë', pinyin: 'k«éol«ú', meaning: 'consider' },
            { char: '‰∏ÄÂ±ÇÊ•º', pinyin: 'y√¨ c√©ng l√≥u', meaning: 'one floor; the same floor' },
            { char: 'ËÄÉËØï', pinyin: 'k«éosh√¨', meaning: 'examination; test' }
        ];

        // Merge all lessons and de-duplicate by character
        const combinedMap = new Map();
        [...lesson1, ...lesson2, ...lesson3, ...lesson4, ...lesson5, ...lesson6, ...lesson7part1, ...lesson7part2].forEach(item => {
            if (!combinedMap.has(item.char)) {
                combinedMap.set(item.char, item);
            }
        });
        const characters = Array.from(combinedMap.values());

        initQuiz(characters, {
            enablePreviewQueue: true,
            previewQueueSize: 1,
            previewElementId: 'upcomingCharacters',
            previewApplicableModes: ['char-to-meaning-type', 'char-to-meaning', 'audio-to-meaning']
        });
    </script>
</body>
</html>
